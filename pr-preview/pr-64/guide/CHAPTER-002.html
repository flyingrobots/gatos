<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Chapter 2–The Ledger Plane: An Immutable History | GATOS</title>
    <meta name="description" content="Git As The Operating Surface">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/gatos/pr-preview/pr-64/assets/style.B4hd1-5U.css" as="style">
    <link rel="preload stylesheet" href="/gatos/pr-preview/pr-64/vp-icons.css" as="style">
    
    <script type="module" src="/gatos/pr-preview/pr-64/assets/app.DrRrGYUm.js"></script>
    <link rel="preload" href="/gatos/pr-preview/pr-64/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/gatos/pr-preview/pr-64/assets/chunks/theme.C6RZ5RmL.js">
    <link rel="modulepreload" href="/gatos/pr-preview/pr-64/assets/chunks/framework.BXNB9gP7.js">
    <link rel="modulepreload" href="/gatos/pr-preview/pr-64/assets/guide_CHAPTER-002.md.blg3WmDU.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
    <script>import("/gatos/pr-preview/pr-64/pagefind/pagefind.js").then(i=>{window.__pagefind__=i,i.init()}).catch(()=>{});</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0b0ada53></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0b0ada53>Skip to content</a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle has-sidebar" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/gatos/pr-preview/pr-64/" data-v-1168a8e4><!--[--><!--]--><!----><span data-v-1168a8e4>GATOS</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="blog-search search" data-pagefind-ignore="all" data-v-6aa21345 data-v-9c3ad077><div class="nav-search-btn-wait" data-v-9c3ad077><span data-v-9c3ad077><svg width="14" height="14" viewBox="0 0 20 20" data-v-9c3ad077><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" data-v-9c3ad077></path></svg></span><span class="search-tip" data-v-9c3ad077>Search</span><span class="metaKey" data-v-9c3ad077> K </span></div><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/gatos/pr-preview/pr-64/guide/CHAPTER-001.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Book</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/gatos/pr-preview/pr-64/SPEC.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>SPEC</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/gatos/pr-preview/pr-64/TECH-SPEC.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>TECH-SPEC</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/gatos/pr-preview/pr-64/decisions/README.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>ADRs</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6aa21345 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/flyingrobots/gatos" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/flyingrobots/gatos" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-8a42e2b4><button data-v-8a42e2b4>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 has-active" data-v-c40bc020 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h2 class="text" data-v-b3fd67f8>The GATOS Book</h2><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-001.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 1: The GATOS System Model</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-002.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 2–The Ledger Plane: An Immutable History</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-003.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 3: The State Plane: Deterministic Folds</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-004.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 4: The Policy Plane: Governance as Code</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-005.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 5: Project Stargate: Local Enforcement & Magic Mirrors</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-006.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 6: The Message & Job Planes: Distributed Workflows</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-007.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 7: Federation & Mind-Melds: Cross-Repo Operations</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-008.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 8: Interfaces & Integration</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-009.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 9: The GATOS Morphology Calculus</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-010.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 10: Proofs, Attestation, and Privacy</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-011.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 11: Performance: Partial Folds, Caching, and Exploration</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-012.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 12: The GATOS Vision</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>On this page</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _gatos_pr-preview_pr-64_guide_CHAPTER-002" data-v-39a288b8><div data-pagefind-body="true"><h1 id="chapter-2–the-ledger-plane-an-immutable-history" tabindex="-1">Chapter 2–The Ledger Plane: An Immutable History <a class="header-anchor" href="#chapter-2–the-ledger-plane-an-immutable-history" aria-label="Permalink to &quot;Chapter 2–The Ledger Plane: An Immutable History&quot;">​</a></h1><p><a id="chapter-2the-ledger-plane-an-immutable-history"></a></p><p><a id="chapter-2the-ledger-plane-an-immutable-history"></a></p><ul><li><a href="#git-as-an-append-only-log">Git as an Append-Only Log</a></li><li><a href="#the-event-envelope">The Event Envelope</a><ul><li><a href="#canonicalization-and-signing-dag-cbor">Canonicalization and Signing (DAG-CBOR)</a></li></ul></li><li><a href="#the-gatos-ledger-crate">The gatos-ledger Crate</a></li><li><a href="#the-workflow-appending-an-event">The Workflow: Appending an Event</a></li><li><a href="#summary">Summary</a></li></ul><p><a id="chapter-2the-ledger-plane-an-immutable-history"></a></p><p>The <strong>Ledger Plane</strong> is the bedrock of the GATOS system. It is the immutable, append-only journal where all significant actions are recorded as cryptographically signed <strong>events</strong>. This plane provides the verifiable source of truth from which all other state is derived. The primary component responsible for this plane is the <strong><code>gatos-ledger</code></strong> crate.</p><h2 id="git-as-an-append-only-log" tabindex="-1">Git as an Append-Only Log <a class="header-anchor" href="#git-as-an-append-only-log" aria-label="Permalink to &quot;Git as an Append-Only Log&quot;">​</a></h2><p><a id="git-as-an-append-only-log"></a></p><p><a id="git-as-an-append-only-log"></a> The core function of the Ledger Plane is to record a sequence of events in a way that is both permanent and tamper-evident. Instead of using a traditional database or a complex blockchain, GATOS leverages the fundamental properties of Git itself to achieve this.</p><ol><li><strong>Events as Commits:</strong> Every event written to the ledger is a Git commit. The commit message contains a structured <strong><code>EventEnvelope</code></strong> with the event&#39;s type, payload, actor, and other metadata.</li><li><strong>Cryptographic Chain:</strong> Each new commit has the previous event&#39;s commit as its parent. This creates a linked list of commits, where the hash of each commit depends on the entire history that came before it. Any attempt to alter a past event would change its hash, which would in turn change the hash of every subsequent commit, breaking the chain and making the tampering immediately obvious.</li><li><strong>Custom Refspace:</strong> To keep the ledger separate from source code, all journal entries are stored under a dedicated Git ref namespace: <code>refs/gatos/journal/</code>. This allows for granular organization, for example, by namespace and actor (<code>refs/gatos/journal/&lt;namespace&gt;/&lt;actor&gt;</code>).</li><li><strong>Fast-Forward Only:</strong> The GATOS system enforces a <strong>fast-forward only</strong> policy on all journal refs. This means that history can only be added to; it can never be rewritten or reordered. This is the key to ensuring the immutability of the ledger.</li></ol><p>The following diagram illustrates how events are appended to a journal ref, forming a simple, linear, and unbreakable chain of history.</p><figure><img src="/gatos/pr-preview/pr-64/assets/docs_guide_CHAPTER-002__ce96c5a0d0__mermaid_1.Cz3yakeW.svg" alt="diagram 1" loading="lazy"></figure><blockquote><p>Note: Diagrams on this site are pre-rendered as static SVGs. The <code>gitGraph</code> source requires Mermaid 10+ at build time, but no client-side Mermaid renderer is needed to view the diagram.</p></blockquote><h2 id="the-event-envelope" tabindex="-1">The Event Envelope <a class="header-anchor" href="#the-event-envelope" aria-label="Permalink to &quot;The Event Envelope&quot;">​</a></h2><p><a id="the-event-envelope"></a></p><p><a id="the-event-envelope"></a> Every action in GATOS is initiated by an <strong><code>Event</code></strong>. This event is wrapped in a standardized <strong><code>EventEnvelope</code></strong> before being committed to the ledger. This envelope contains all the necessary metadata for processing and auditing.</p><figure><img src="/gatos/pr-preview/pr-64/assets/docs_guide_CHAPTER-002__ce96c5a0d0__mermaid_2.B6hW8Rjm.svg" alt="diagram 2" loading="lazy"></figure><ul><li><strong><code>type</code></strong>: A string identifying the kind of event (e.g., <code>jobs.enqueue</code>, <code>policy.approve</code>).</li><li><strong><code>ulid</code></strong>: A universally unique, lexicographically sortable identifier for the event.</li><li><strong><code>actor</code></strong>: The identity of the user, agent, or service that initiated the event.</li><li><strong><code>caps</code></strong>: A list of capability tokens held by the actor, used by the Policy Plane to authorize the action.</li><li><strong><code>payload</code></strong>: The domain-specific data for the event.</li><li><strong><code>policy_root</code></strong>: The hash/commit of the policy state that was used to approve this event.</li><li><strong><code>sig_alg</code></strong>: The signature algorithm used (e.g., <code>ed25519</code>).</li><li><strong><code>ts</code></strong>: Timestamp of authorship (monotonic per ref).</li></ul><h3 id="canonicalization-and-signing-dag-cbor" tabindex="-1">Canonicalization and Signing (DAG-CBOR) <a class="header-anchor" href="#canonicalization-and-signing-dag-cbor" aria-label="Permalink to &quot;Canonicalization and Signing (DAG-CBOR)&quot;">​</a></h3><p><a id="canonicalization-and-signing-dag-cbor"></a></p><p><a id="canonicalization-and-signing-dag-cbor"></a><a id="canonicalization-and-signing-dagcbor"></a></p><ul><li>Canonical form: Events are encoded as <strong>DAG-CBOR</strong>. The canonical bytes are used for hashing and signing.</li><li>Content addressing: <code>Event-CID = cidv1(dag-cbor, blake3(canonical_bytes))</code>.</li><li>Signing: The signature is computed over the canonical DAG-CBOR bytes with the <code>sig</code> field omitted and recorded in commit trailers.</li><li>Recommended commit trailers: <ul><li><code>Event-CID: cidv1:...</code></li><li><code>Sig-Alg: ed25519</code></li><li><code>Sig: ed25519:&lt;hex|base64&gt;</code></li></ul></li></ul><h2 id="the-gatos-ledger-crate" tabindex="-1">The <code>gatos-ledger</code> Crate <a class="header-anchor" href="#the-gatos-ledger-crate" aria-label="Permalink to &quot;The `gatos-ledger` Crate&quot;">​</a></h2><p><a id="the-gatos-ledger-crate"></a></p><p><a id="the-gatos-ledger-crate"></a> The <strong><code>gatos-ledger</code></strong> crate provides the core logic for interacting with the Ledger Plane. It is composed of two main parts:</p><ul><li><strong><code>gatos-ledger-core</code>:</strong> A <code>no_std</code> compatible crate that defines the pure, platform-agnostic data structures (like the <code>EventEnvelope</code>) and traits.</li><li><strong><code>gatos-ledger-git</code>:</strong> An adapter that implements the ledger storage backend using <code>libgit2</code>. It handles the creation of commits, atomic updates of refs, and signature verification.</li></ul><p>This separation of concerns, a hallmark of the GATOS architecture, ensures that the core logic is portable and testable, while the specific storage implementation can be swapped out if needed.</p><h2 id="the-workflow-appending-an-event" tabindex="-1">The Workflow: Appending an Event <a class="header-anchor" href="#the-workflow-appending-an-event" aria-label="Permalink to &quot;The Workflow: Appending an Event&quot;">​</a></h2><p><a id="the-workflow-appending-an-event"></a></p><p><a id="the-workflow-appending-an-event"></a> When a client sends a command to <code>gatosd</code>, the following happens in the Ledger Plane:</p><ol><li><strong>Event Creation:</strong> The daemon constructs a full <code>EventEnvelope</code>, including the actor, payload, and capabilities.</li><li><strong>Policy Check:</strong> The event is passed to the Policy Plane. If the action is denied, the process stops, and an audit entry is created. If allowed, the Policy Plane returns a <code>policy_root</code> hash.</li><li><strong>Signing:</strong> The canonicalized event (with the <code>policy_root</code>) is signed by the actor&#39;s key.</li><li><strong>Commit:</strong> <code>gatos-ledger</code> creates a new Git commit with the signed event as its message.</li><li><strong>Atomic Ref Update:</strong> <code>gatos-ledger</code> performs an atomic compare-and-swap operation (<code>git update-ref &lt;old&gt; &lt;new&gt;</code>) to update the appropriate journal ref to point to the new commit, ensuring the fast-forward-only guarantee.</li></ol><h2 id="summary" tabindex="-1">Summary <a class="header-anchor" href="#summary" aria-label="Permalink to &quot;Summary&quot;">​</a></h2><p><a id="summary"></a></p><p><a id="summary"></a> The Ledger Plane is the immutable foundation of GATOS. By using Git&#39;s own robust, distributed, and cryptographically secure data structures, <code>gatos-ledger</code> provides a powerful and elegant solution for creating a complete and verifiable history of every action in the system. This auditable log is the essential input for all other planes, enabling the deterministic state folds and governance checks that make GATOS a truly trustworthy operating surface.</p></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><div class="edit-info" data-v-e257564d><!----><div class="last-updated" data-v-e257564d><p class="VPLastUpdated" data-v-e257564d data-v-e98dd255>Last updated: <time datetime="2025-11-14T12:59:51.000Z" data-v-e98dd255></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/gatos/pr-preview/pr-64/guide/CHAPTER-001.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Previous page</span><span class="title" data-v-e257564d>Chapter 1: The GATOS System Model</span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/gatos/pr-preview/pr-64/guide/CHAPTER-003.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>Chapter 3: The State Plane: Deterministic Folds</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"cli_export.md\":\"CLzSJGcU\",\"cli_foldc.md\":\"BlAnbZO9\",\"cli_lint.md\":\"mj1fpTew\",\"cli_policyc.md\":\"DKnkH67y\",\"cli_pox.md\":\"DXjQuMOy\",\"decisions_adr-0001_decision.md\":\"DY8GKnrp\",\"decisions_adr-0001_flyingrobots.md\":\"BeNZagF9\",\"decisions_adr-0002_decision.md\":\"Bf0iCuj1\",\"decisions_adr-0003_decision.md\":\"-ok879zO\",\"decisions_readme.md\":\"KkXmD_F3\",\"deterministic-lua.md\":\"CVw_7KLx\",\"diagrams_api_endpoints.md\":\"CdqpFgfg\",\"diagrams_architecture.md\":\"CBAnxxWK\",\"diagrams_data_flow.md\":\"0E-X8bye\",\"diagrams_state_management.md\":\"B-gSiSg7\",\"exporter.md\":\"ClnSw-BK\",\"faq.md\":\"BH1NJFje\",\"features.md\":\"DMVqw-iT\",\"guide_chapter-001.md\":\"DcFaCqRD\",\"guide_chapter-002.md\":\"blg3WmDU\",\"guide_chapter-003.md\":\"BuTj0Pj3\",\"guide_chapter-004.md\":\"Czs3YQr1\",\"guide_chapter-005.md\":\"Bsm1S1mp\",\"guide_chapter-006.md\":\"COflY9m5\",\"guide_chapter-007.md\":\"DpXu0z36\",\"guide_chapter-008.md\":\"CnE5B4uo\",\"guide_chapter-009.md\":\"CPIojlOm\",\"guide_chapter-010.md\":\"CJX0wYwq\",\"guide_chapter-011.md\":\"PtYa1OkK\",\"guide_chapter-012.md\":\"COsXIEah\",\"guide_hello-ops.md\":\"BG_AL01p\",\"guide_hello-privacy.md\":\"Bh3WgWZ_\",\"guide_readme.md\":\"V2870IoA\",\"index.md\":\"CpZ-254t\",\"opaque-pointers.md\":\"DxndSgTU\",\"opaque-resolver.md\":\"0MKZ6RMu\",\"proofs_proof-of-consensus.md\":\"6CV-riRB\",\"proofs_proof-of-execution.md\":\"97Xi_UHC\",\"proofs_proof-of-experiment.md\":\"B7qAYY4K\",\"proofs_proof-of-fold.md\":\"BhUVd11q\",\"research-profile.md\":\"D8VzH1Rb\",\"roadmap-xtask.md\":\"BKrvI000\",\"roadmap.md\":\"BUlW7X-N\",\"spec.md\":\"BsvtdxMb\",\"stakeholders.md\":\"BkOtxI3h\",\"stargate-push-gate.md\":\"Bcn2Nd-U\",\"tasks.md\":\"BIW_QAbe\",\"tech-spec.md\":\"DuSHpVtA\",\"use-cases.md\":\"vEICr4Xr\",\"why-not-x.md\":\"Bavde5gq\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"GATOS\",\"description\":\"Git As The Operating Surface\",\"base\":\"/gatos/pr-preview/pr-64/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Book\",\"link\":\"/guide/CHAPTER-001\"},{\"text\":\"SPEC\",\"link\":\"/SPEC\"},{\"text\":\"TECH-SPEC\",\"link\":\"/TECH-SPEC\"},{\"text\":\"ADRs\",\"link\":\"/decisions/README\"}],\"sidebar\":{\"/guide/\":[{\"text\":\"The GATOS Book\",\"items\":[{\"text\":\"Chapter 1: The GATOS System Model\",\"link\":\"/guide/CHAPTER-001\"},{\"text\":\"Chapter 2–The Ledger Plane: An Immutable History\",\"link\":\"/guide/CHAPTER-002\"},{\"text\":\"Chapter 3: The State Plane: Deterministic Folds\",\"link\":\"/guide/CHAPTER-003\"},{\"text\":\"Chapter 4: The Policy Plane: Governance as Code\",\"link\":\"/guide/CHAPTER-004\"},{\"text\":\"Chapter 5: Project Stargate: Local Enforcement & Magic Mirrors\",\"link\":\"/guide/CHAPTER-005\"},{\"text\":\"Chapter 6: The Message & Job Planes: Distributed Workflows\",\"link\":\"/guide/CHAPTER-006\"},{\"text\":\"Chapter 7: Federation & Mind-Melds: Cross-Repo Operations\",\"link\":\"/guide/CHAPTER-007\"},{\"text\":\"Chapter 8: Interfaces & Integration\",\"link\":\"/guide/CHAPTER-008\"},{\"text\":\"Chapter 9: The GATOS Morphology Calculus\",\"link\":\"/guide/CHAPTER-009\"},{\"text\":\"Chapter 10: Proofs, Attestation, and Privacy\",\"link\":\"/guide/CHAPTER-010\"},{\"text\":\"Chapter 11: Performance: Partial Folds, Caching, and Exploration\",\"link\":\"/guide/CHAPTER-011\"},{\"text\":\"Chapter 12: The GATOS Vision\",\"link\":\"/guide/CHAPTER-012\"}]}],\"/\":[{\"text\":\"Reference\",\"items\":[{\"text\":\"SPEC\",\"link\":\"/SPEC\"},{\"text\":\"TECH-SPEC\",\"link\":\"/TECH-SPEC\"},{\"text\":\"ADRs\",\"link\":\"/decisions/README\"}]}]},\"outline\":\"deep\",\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/flyingrobots/gatos\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>