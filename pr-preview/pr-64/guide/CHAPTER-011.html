<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Chapter 11: Performance: Partial Folds, Caching, and Exploration | GATOS</title>
    <meta name="description" content="Git As The Operating Surface">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/gatos/pr-preview/pr-64/assets/style.B4hd1-5U.css" as="style">
    <link rel="preload stylesheet" href="/gatos/pr-preview/pr-64/vp-icons.css" as="style">
    
    <script type="module" src="/gatos/pr-preview/pr-64/assets/app.DrRrGYUm.js"></script>
    <link rel="preload" href="/gatos/pr-preview/pr-64/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/gatos/pr-preview/pr-64/assets/chunks/theme.C6RZ5RmL.js">
    <link rel="modulepreload" href="/gatos/pr-preview/pr-64/assets/chunks/framework.BXNB9gP7.js">
    <link rel="modulepreload" href="/gatos/pr-preview/pr-64/assets/guide_CHAPTER-011.md.D1YMZgtf.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
    <script>import("/gatos/pr-preview/pr-64/pagefind/pagefind.js").then(i=>{window.__pagefind__=i,i.init()}).catch(()=>{});</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0b0ada53></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0b0ada53>Skip to content</a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle has-sidebar" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/gatos/pr-preview/pr-64/" data-v-1168a8e4><!--[--><!--]--><!----><span data-v-1168a8e4>GATOS</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="blog-search search" data-pagefind-ignore="all" data-v-6aa21345 data-v-9c3ad077><div class="nav-search-btn-wait" data-v-9c3ad077><span data-v-9c3ad077><svg width="14" height="14" viewBox="0 0 20 20" data-v-9c3ad077><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" data-v-9c3ad077></path></svg></span><span class="search-tip" data-v-9c3ad077>Search</span><span class="metaKey" data-v-9c3ad077> K </span></div><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/gatos/pr-preview/pr-64/guide/CHAPTER-001.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Book</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/gatos/pr-preview/pr-64/SPEC.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>SPEC</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/gatos/pr-preview/pr-64/TECH-SPEC.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>TECH-SPEC</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/gatos/pr-preview/pr-64/decisions/README.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>ADRs</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6aa21345 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/flyingrobots/gatos" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/flyingrobots/gatos" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-8a42e2b4><button data-v-8a42e2b4>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 has-active" data-v-c40bc020 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h2 class="text" data-v-b3fd67f8>The GATOS Book</h2><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-001.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 1: The GATOS System Model</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-002.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 2–The Ledger Plane: An Immutable History</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-003.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 3: The State Plane: Deterministic Folds</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-004.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 4: The Policy Plane: Governance as Code</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-005.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 5: Project Stargate: Local Enforcement & Magic Mirrors</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-006.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 6: The Message & Job Planes: Distributed Workflows</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-007.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 7: Federation & Mind-Melds: Cross-Repo Operations</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-008.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 8: Interfaces & Integration</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-009.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 9: The GATOS Morphology Calculus</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-010.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 10: Proofs, Attestation, and Privacy</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-011.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 11: Performance: Partial Folds, Caching, and Exploration</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/gatos/pr-preview/pr-64/guide/CHAPTER-012.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Chapter 12: The GATOS Vision</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>On this page</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _gatos_pr-preview_pr-64_guide_CHAPTER-011" data-v-39a288b8><div data-pagefind-body="true"><h1 id="chapter-11-performance-partial-folds-caching-and-exploration" tabindex="-1">Chapter 11: Performance: Partial Folds, Caching, and Exploration <a class="header-anchor" href="#chapter-11-performance-partial-folds-caching-and-exploration" aria-label="Permalink to &quot;Chapter 11: Performance: Partial Folds, Caching, and Exploration&quot;">​</a></h1><p><a id="chapter-11-performance-partial-folds-caching-and-exploration"></a></p><ul><li><a href="#partial-and-lazy-folds">Partial and Lazy Folds</a></li><li><a href="#the-cache-plane-and-explorer-off-ramps">The Cache Plane and Explorer Off-Ramps</a><ul><li><a href="#the-cache-plane">The Cache Plane</a><ul><li><a href="#cache-keys-and-correctness">Cache Keys and Correctness</a></li></ul></li><li><a href="#gatos-to-sqlparquet-explorer">GATOS-to-SQL/Parquet Explorer</a><ul><li><a href="#recommended-git-config-for-big-repos">Recommended Git config for big repos</a></li><li><a href="#cache-invalidation-strategy">Cache Invalidation Strategy</a></li><li><a href="#roaring-indexing">Roaring Indexing</a></li></ul></li></ul></li><li><a href="#summary">Summary</a></li></ul><p><a id="chapter-11-performance-partial-folds-caching-and-exploration"></a></p><p>A common concern with systems that rely on immutable history and deterministic replay is performance. If every state change requires re-processing the entire history of the system, how can it possibly scale?</p><p>GATOS is designed from the ground up to be performant at scale. It achieves this through a combination of clever algorithms, a dedicated cache plane, and by providing tools to explore and analyze the data in more efficient formats.</p><h2 id="partial-and-lazy-folds" tabindex="-1">Partial and Lazy Folds <a class="header-anchor" href="#partial-and-lazy-folds" aria-label="Permalink to &quot;Partial and Lazy Folds&quot;">​</a></h2><p><a id="partial-and-lazy-folds"></a> The key to GATOS&#39;s performance is that it rarely needs to re-fold the entire history of the universe. The <strong>GATOS Morphology Calculus</strong> (as described in <a href="./CHAPTER-009.html">Chapter 9</a>) provides the theoretical foundation for this with <strong>Theorem 2 (Localization &amp; Incrementality)</strong>.</p><p>This theorem states that if the system&#39;s history can be broken down into independent regions (i.e., sets of events that don&#39;t have overlapping read/write sets), then the state of the whole is simply the composition of the states of the parts.</p><p>In practice, this means GATOS can perform <strong>partial and lazy folds</strong>:</p><ul><li><strong>Partial Folds:</strong> When a new event comes in, the system can analyze its &quot;footprint&quot; (the data it reads from and writes to) and determine which part of the state graph is affected. It only needs to re-fold that small, relevant partition of the event history.</li><li><strong>Lazy Folds:</strong> Not all state needs to be computed all the time. GATOS can defer the folding of certain parts of the state until they are actually requested.</li></ul><p>This makes the cost of a state update proportional to the size of the change, not the size of the entire history.</p><h2 id="the-cache-plane-and-explorer-off-ramps" tabindex="-1">The Cache Plane and Explorer Off-Ramps <a class="header-anchor" href="#the-cache-plane-and-explorer-off-ramps" aria-label="Permalink to &quot;The Cache Plane and Explorer Off-Ramps&quot;">​</a></h2><p><a id="the-cache-plane-and-explorer-off-ramps"></a> To further optimize performance, GATOS includes a dedicated <strong>Cache Plane</strong> and provides &quot;off-ramps&quot; to traditional data exploration tools. These are secondary, non-authoritative views of the data, derived deterministically from the Ledger.</p><figure><img src="/gatos/pr-preview/pr-64/assets/docs_guide_CHAPTER-011__aa1e158511__mermaid_1.Dv6mV3xw.svg" alt="diagram 1" loading="lazy"></figure><h3 id="the-cache-plane" tabindex="-1">The Cache Plane <a class="header-anchor" href="#the-cache-plane" aria-label="Permalink to &quot;The Cache Plane&quot;">​</a></h3><p><a id="the-cache-plane"></a></p><ul><li><strong>Location:</strong> The cache lives under the <code>refs/gatos/cache/</code> refspace in Git.</li><li><strong>Content:</strong> The cache can store various artifacts, but its most important content is indexes built from <strong>Roaring Bitmaps</strong>.</li><li><strong>Roaring Bitmaps:</strong> These are highly compressed, efficient data structures for storing and performing operations on large sets of integers. The GATOS indexer processes the event journal and creates roaring bitmap indexes for fast querying (e.g., &quot;find all events related to user X&quot;).</li></ul><p>Because the cache is just a result of a deterministic fold, it can be safely deleted and rebuilt at any time. It is a pure optimization and not part of the authoritative state of the system.</p><h4 id="cache-keys-and-correctness" tabindex="-1">Cache Keys and Correctness <a class="header-anchor" href="#cache-keys-and-correctness" aria-label="Permalink to &quot;Cache Keys and Correctness&quot;">​</a></h4><p><a id="cache-keys-and-correctness"></a> Top-level cache keys MUST include:</p><ul><li><code>ledger_head</code></li><li><code>policy_root</code></li><li><code>fold_engine_id</code> (e.g., <code>echo@0.7.3</code>)</li><li><code>fold_version</code> (e.g., <code>gatos-echo-fold@1</code>)</li></ul><p>Partial/unit caches (ADR-0013) SHOULD derive keys such as:</p><ul><li><code>Unit-Key = blake3(code_hash || policy_root || …)</code></li></ul><h3 id="gatos-to-sql-parquet-explorer" tabindex="-1">GATOS-to-SQL/Parquet Explorer <a class="header-anchor" href="#gatos-to-sql-parquet-explorer" aria-label="Permalink to &quot;GATOS-to-SQL/Parquet Explorer&quot;">​</a></h3><p><a id="gatos-to-sqlparquet-explorer"></a> While the Git-native storage of GATOS is perfect for auditability and distribution, it is not always the most efficient format for large-scale analytical queries. For this, GATOS provides an <strong>explorer</strong> or <strong>&quot;off-ramp&quot;</strong> mechanism.</p><p>A dedicated process can be configured to follow the GATOS ledger and deterministically transform the event data into a more traditional analytical format, such as:</p><ul><li>A <strong>SQL database</strong> (e.g., PostgreSQL or DuckDB).</li><li>A set of <strong>Parquet files</strong> in a data lake.</li></ul><p>This allows standard business intelligence (BI) tools, dashboards, and data science notebooks to run complex analytical queries over the GATOS data without having to understand the underlying Git-based storage model.</p><p>Explorer views are read-only. Provide a canonical checksum:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Explorer-Root = blake3(ledger_head || policy_root || extractor_version)</span></span></code></pre></div><h4 id="recommended-git-config-for-big-repos" tabindex="-1">Recommended Git config for big repos <a class="header-anchor" href="#recommended-git-config-for-big-repos" aria-label="Permalink to &quot;Recommended Git config for big repos&quot;">​</a></h4><p><a id="recommended-git-config-for-big-repos"></a></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>git config --global fetch.writeCommitGraph true</span></span>
<span class="line"><span>git config --global repack.writeBitmaps true</span></span>
<span class="line"><span>git config --global repack.packKeptObjects false</span></span></code></pre></div><p>Consider partial clone and promisor remotes for <code>refs/gatos/mbus/*</code>.</p><h4 id="cache-invalidation-strategy" tabindex="-1">Cache Invalidation Strategy <a class="header-anchor" href="#cache-invalidation-strategy" aria-label="Permalink to &quot;Cache Invalidation Strategy&quot;">​</a></h4><p><a id="cache-invalidation-strategy"></a><a id="cache-invalidation-oneliner"></a></p><ol><li>Build a footprint map tracking which cache segments depend on which event ranges.</li><li>On new events, compute impacted regions by intersecting the event&#39;s read/write set with the footprint map.</li><li>Drop those cache segments.</li><li>Re-fold only the impacted units on next query.</li></ol><h4 id="roaring-indexing" tabindex="-1">Roaring Indexing <a class="header-anchor" href="#roaring-indexing" aria-label="Permalink to &quot;Roaring Indexing&quot;">​</a></h4><p><a id="roaring-indexing"></a> Index by ULID time, entity id, and event type:</p><ul><li>Time dimension: Extract millisecond epoch from ULID prefix (48 bits), truncate to suitable granularity (for example, hour buckets).</li><li>Entity dimension: Maintain a stable id→int mapping persisted in cache metadata.</li><li>Event type dimension: Use a fixed enum or a hash-to-int mapping with collision handling.</li></ul><p>Encodings must be deterministic and versioned to maintain cache correctness across fold engine updates.</p><p>The key is that this transformation is itself a <strong>deterministic fold</strong>. The analytical database is a secondary, verifiable view of the primary data in the ledger. You can always rebuild it from scratch and get the exact same result.</p><h2 id="summary" tabindex="-1">Summary <a class="header-anchor" href="#summary" aria-label="Permalink to &quot;Summary&quot;">​</a></h2><p><a id="summary"></a> GATOS is designed for both correctness and performance. It achieves high performance not by cutting corners on its guarantees, but by applying its core principles of determinism and mathematical rigor to the problem of optimization.</p><ul><li><strong>Partial and Lazy Folds</strong> make state updates efficient by minimizing re-computation.</li><li><strong>The Cache Plane</strong> provides rebuildable, high-speed indexes for fast queries.</li><li><strong>Explorer Off-ramps</strong> bridge the gap to the traditional world of data analytics, providing a verifiable, read-optimized view of the GATOS ledger.</li></ul><p>This combination allows GATOS to serve as both a high-integrity transactional system and a high-performance analytical backend, without compromising on its core principles.</p></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><div class="edit-info" data-v-e257564d><!----><div class="last-updated" data-v-e257564d><p class="VPLastUpdated" data-v-e257564d data-v-e98dd255>Last updated: <time datetime="2025-11-14T14:31:52.000Z" data-v-e98dd255></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/gatos/pr-preview/pr-64/guide/CHAPTER-010.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Previous page</span><span class="title" data-v-e257564d>Chapter 10: Proofs, Attestation, and Privacy</span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/gatos/pr-preview/pr-64/guide/CHAPTER-012.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>Chapter 12: The GATOS Vision</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"cli_export.md\":\"DjklJxoF\",\"cli_foldc.md\":\"BtosYHBc\",\"cli_lint.md\":\"CaRAKxk3\",\"cli_policyc.md\":\"BRTXo_0U\",\"cli_pox.md\":\"C9KDNAP2\",\"decisions_adr-0001_decision.md\":\"DZXkXIW7\",\"decisions_adr-0001_flyingrobots.md\":\"VqulVg3z\",\"decisions_adr-0002_decision.md\":\"DAqipNWV\",\"decisions_adr-0003_decision.md\":\"CZLA-fFC\",\"decisions_readme.md\":\"Bd2XG4k1\",\"deterministic-lua.md\":\"B-5ajmCQ\",\"diagrams_api_endpoints.md\":\"DdrJIbN0\",\"diagrams_architecture.md\":\"BEoaqTZV\",\"diagrams_data_flow.md\":\"CJXkskDI\",\"diagrams_state_management.md\":\"FQWwn1H0\",\"exporter.md\":\"CQnXc5cz\",\"faq.md\":\"BgVjS_bf\",\"features.md\":\"DhejEzrG\",\"guide_chapter-001.md\":\"Ya05U0xP\",\"guide_chapter-002.md\":\"30zU5WI4\",\"guide_chapter-003.md\":\"ngnjQsRW\",\"guide_chapter-004.md\":\"t8W7WN8_\",\"guide_chapter-005.md\":\"5DlzQ__S\",\"guide_chapter-006.md\":\"BKsW7WRM\",\"guide_chapter-007.md\":\"CFVM49yd\",\"guide_chapter-008.md\":\"DipqVoPJ\",\"guide_chapter-009.md\":\"Dg8XEXXp\",\"guide_chapter-010.md\":\"CdXUA8d7\",\"guide_chapter-011.md\":\"D1YMZgtf\",\"guide_chapter-012.md\":\"B5fcWGr7\",\"guide_hello-ops.md\":\"B7anox8O\",\"guide_hello-privacy.md\":\"CRzcBXJy\",\"guide_readme.md\":\"QgWykhCE\",\"index.md\":\"C9jU_M-R\",\"opaque-pointers.md\":\"CFvjmGtb\",\"opaque-resolver.md\":\"Ba2qmdme\",\"proofs_proof-of-consensus.md\":\"CsTyB-vo\",\"proofs_proof-of-execution.md\":\"BLRE25JN\",\"proofs_proof-of-experiment.md\":\"CCxwypB6\",\"proofs_proof-of-fold.md\":\"CV2sG5st\",\"research-profile.md\":\"3-6lVeUV\",\"roadmap-xtask.md\":\"tmt1-H8o\",\"roadmap.md\":\"2bQ9jSWr\",\"spec.md\":\"Hl0Ajy93\",\"stakeholders.md\":\"DxRJHxHM\",\"stargate-push-gate.md\":\"DcL0jd41\",\"tasks.md\":\"DjZ5PPob\",\"tech-spec.md\":\"CkZdU6wA\",\"use-cases.md\":\"BUro0XpV\",\"why-not-x.md\":\"C6u06TnR\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"GATOS\",\"description\":\"Git As The Operating Surface\",\"base\":\"/gatos/pr-preview/pr-64/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Book\",\"link\":\"/guide/CHAPTER-001\"},{\"text\":\"SPEC\",\"link\":\"/SPEC\"},{\"text\":\"TECH-SPEC\",\"link\":\"/TECH-SPEC\"},{\"text\":\"ADRs\",\"link\":\"/decisions/README\"}],\"sidebar\":{\"/guide/\":[{\"text\":\"The GATOS Book\",\"items\":[{\"text\":\"Chapter 1: The GATOS System Model\",\"link\":\"/guide/CHAPTER-001\"},{\"text\":\"Chapter 2–The Ledger Plane: An Immutable History\",\"link\":\"/guide/CHAPTER-002\"},{\"text\":\"Chapter 3: The State Plane: Deterministic Folds\",\"link\":\"/guide/CHAPTER-003\"},{\"text\":\"Chapter 4: The Policy Plane: Governance as Code\",\"link\":\"/guide/CHAPTER-004\"},{\"text\":\"Chapter 5: Project Stargate: Local Enforcement & Magic Mirrors\",\"link\":\"/guide/CHAPTER-005\"},{\"text\":\"Chapter 6: The Message & Job Planes: Distributed Workflows\",\"link\":\"/guide/CHAPTER-006\"},{\"text\":\"Chapter 7: Federation & Mind-Melds: Cross-Repo Operations\",\"link\":\"/guide/CHAPTER-007\"},{\"text\":\"Chapter 8: Interfaces & Integration\",\"link\":\"/guide/CHAPTER-008\"},{\"text\":\"Chapter 9: The GATOS Morphology Calculus\",\"link\":\"/guide/CHAPTER-009\"},{\"text\":\"Chapter 10: Proofs, Attestation, and Privacy\",\"link\":\"/guide/CHAPTER-010\"},{\"text\":\"Chapter 11: Performance: Partial Folds, Caching, and Exploration\",\"link\":\"/guide/CHAPTER-011\"},{\"text\":\"Chapter 12: The GATOS Vision\",\"link\":\"/guide/CHAPTER-012\"}]}],\"/\":[{\"text\":\"Reference\",\"items\":[{\"text\":\"SPEC\",\"link\":\"/SPEC\"},{\"text\":\"TECH-SPEC\",\"link\":\"/TECH-SPEC\"},{\"text\":\"ADRs\",\"link\":\"/decisions/README\"}]}]},\"outline\":\"deep\",\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/flyingrobots/gatos\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>