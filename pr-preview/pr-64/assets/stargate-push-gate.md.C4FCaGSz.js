import{_ as i,c as a,o as e,a3 as t}from"./chunks/framework.BXNB9gP7.js";const E=JSON.parse('{"title":"Stargate — Push-Gate Enforcement","description":"","frontmatter":{"title":"Stargate — Push-Gate Enforcement"},"headers":[],"relativePath":"stargate-push-gate.md","filePath":"stargate-push-gate.md","lastUpdated":1763117181000}'),h={name:"stargate-push-gate.md"};function n(r,s,k,p,l,o){return e(),a("div",{"data-pagefind-body":!0},[...s[0]||(s[0]=[t(`<h1 id="stargate-—-push-gate-enforcement" tabindex="-1">Stargate — Push-Gate Enforcement <a class="header-anchor" href="#stargate-—-push-gate-enforcement" aria-label="Permalink to &quot;Stargate — Push-Gate Enforcement&quot;">​</a></h1><p><a id="stargate-push-gate-enforcement"></a></p><ul><li><a href="#enforcement-normative">Enforcement (Normative)</a></li><li><a href="#pre-receive-hook-sketch">Pre-Receive Hook (Sketch)</a></li></ul><p><a id="stargate-pushgate-enforcement"></a></p><p>The push-gate enforces invariants at the repository boundary.</p><h2 id="enforcement-normative" tabindex="-1">Enforcement (Normative) <a class="header-anchor" href="#enforcement-normative" aria-label="Permalink to &quot;Enforcement (Normative)&quot;">​</a></h2><p><a id="enforcement-normative"></a></p><ul><li>Fast-forward only: <code>refs/gatos/policies/**</code>, <code>refs/gatos/state/**</code>, <code>refs/gatos/audit/**</code>.</li><li>PoF required: pushes to <code>refs/gatos/state/**</code> MUST include a verifiable Proof-of-Fold ([[[[[[[<a href="/gatos/pr-preview/pr-64/SPEC.html#5.4">SPEC §5.4</a>](/SPEC#5.4)](/SPEC#5.4)](/SPEC#5.4)](/SPEC#5.4)](/SPEC#5.4)](/SPEC#5.4)](/SPEC#5.4)).</li><li>DENY decisions are logged under <code>refs/gatos/audit/policy/**</code>.</li></ul><h2 id="pre-receive-hook-sketch" tabindex="-1">Pre-Receive Hook (Sketch) <a class="header-anchor" href="#pre-receive-hook-sketch" aria-label="Permalink to &quot;Pre-Receive Hook (Sketch)&quot;">​</a></h2><p><a id="pre-receive-hook-sketch"></a><a id="prereceive-hook-sketch"></a></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># pseudo: pre-receive</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">while</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> read</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> old</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> new</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ff_only_ref</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ref</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> is_fast_forward</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$old</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$new</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">then</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> deny</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ref</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fi</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> is_state_ref</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ref</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> verify_pof</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$new</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">then</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> deny</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ref</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fi</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">done</span></span></code></pre></div><p>Denied updates MUST be accompanied by an audit entry that includes <code>Policy-Rule</code>, reason, and context (actor, target, refs).</p>`,12)])])}const c=i(h,[["render",n]]);export{E as __pageData,c as default};
