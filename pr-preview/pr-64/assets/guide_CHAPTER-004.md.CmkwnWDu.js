import{_ as a,c as s,o as t,a3 as i}from"./chunks/framework.BXNB9gP7.js";const o="/gatos/pr-preview/pr-64/assets/docs_guide_CHAPTER-004__1f1d16e32d__mermaid_1.DGnyGBWe.svg",n="/gatos/pr-preview/pr-64/assets/docs_guide_CHAPTER-004__1f1d16e32d__mermaid_2.dhdoYf4q.svg",k=JSON.parse('{"title":"Chapter 4: The Policy Plane: Governance as Code","description":"","frontmatter":{},"headers":[],"relativePath":"guide/CHAPTER-004.md","filePath":"guide/CHAPTER-004.md","lastUpdated":1763128910000}'),r={name:"guide/CHAPTER-004.md"};function l(p,e,d,h,c,g){return t(),s("div",{"data-pagefind-body":!0},[...e[0]||(e[0]=[i('<h1 id="chapter-4-the-policy-plane-governance-as-code" tabindex="-1">Chapter 4: The Policy Plane: Governance as Code <a class="header-anchor" href="#chapter-4-the-policy-plane-governance-as-code" aria-label="Permalink to &quot;Chapter 4: The Policy Plane: Governance as Code&quot;">​</a></h1><p><a id="chapter-4-the-policy-plane-governance-as-code"></a></p><ul><li><a href="#the-gate-contract">The Gate Contract</a></li><li><a href="#capabilities-and-grants">Capabilities and Grants</a></li><li><a href="#key-management">Key Management</a></li><li><a href="#consensus-governance">Consensus Governance</a><ul><li><a href="#quorum-example-deploy-requires-23-of-leads">Quorum Example (Deploy requires 2/3 of @leads)</a></li></ul></li><li><a href="#summary">Summary</a></li></ul><p><a id="chapter-4-the-policy-plane-governance-as-code"></a></p><p>In a distributed, multi-agent system like GATOS, it&#39;s not enough for actions to be recorded immutably. They must also be <strong>authorized</strong>. The <strong>Policy Plane</strong> is the governance layer of GATOS, responsible for enforcing rules, managing permissions, and orchestrating consensus. It acts as the set of physical laws governing the <strong>operating surface</strong>, ensuring that it can only be <strong>folded</strong> in valid ways. This plane is primarily managed by the <strong><code>gatos-policy</code></strong> crate.</p><h2 id="the-gate-contract" tabindex="-1">The Gate Contract <a class="header-anchor" href="#the-gate-contract" aria-label="Permalink to &quot;The Gate Contract&quot;">​</a></h2><p><a id="the-gate-contract"></a> At the heart of the Policy Plane is the <strong>Gate Contract</strong>. Before any proposed event is committed to the ledger, it is presented to the Policy Gate for evaluation.</p><p>The gate&#39;s contract is simple: <code>Decision = Gate.evaluate(intent, context) -&gt; {Allow | Deny(reason)}</code></p><ul><li><strong>Intent:</strong> The <code>EventEnvelope</code> that the actor wishes to commit.</li><li><strong>Context:</strong> The current state of the world, including the actor&#39;s identity and the state of any relevant policies.</li></ul><p>If the gate returns <code>Allow</code>, the event is signed with the hash of the policy that approved it (<strong><code>policy_root</code></strong>) and is then passed to the Ledger Plane to be recorded.</p><p>If the gate returns <code>Deny(reason)</code>, the event is rejected. Crucially, this denial is itself recorded as an auditable event in a separate <code>refs/gatos/audit/policy</code> journal. This means that even attempted policy violations leave a permanent, verifiable trace, embodying a <strong>Zero Trust</strong> security model.</p><figure><img src="'+o+'" alt="diagram 1" loading="lazy"></figure><h2 id="capabilities-and-grants" tabindex="-1">Capabilities and Grants <a class="header-anchor" href="#capabilities-and-grants" aria-label="Permalink to &quot;Capabilities and Grants&quot;">​</a></h2><p><a id="capabilities-and-grants"></a> The Policy Plane uses a <strong>capability-based security model</strong>. Instead of complex access control lists, permissions are defined as simple, human-readable <strong>capability tokens</strong> (e.g., <code>jobs.enqueue</code>, <code>governance.approve</code>).</p><p>An actor can only perform an action if their <code>EventEnvelope</code> contains the required capability tokens.</p><p>How do actors get capabilities? Through <strong>Grants</strong>. A Grant is a signed, verifiable object that links an <strong><code>issuer</code></strong> (an actor with the authority to grant capabilities) to a <strong><code>subject</code></strong> (the actor receiving the capabilities). Grants have an expiration date and are stored in the Git repository under <code>gatos/trust/grants/</code>.</p><p>This model makes permissions explicit, portable, and auditable.</p><h2 id="key-management" tabindex="-1">Key Management <a class="header-anchor" href="#key-management" aria-label="Permalink to &quot;Key Management&quot;">​</a></h2><p><a id="key-management"></a> GATOS relies on strong, explicit key hygiene.</p><ul><li><strong>Issuance and Trust Roots:</strong> Actor keys (e.g., <code>ed25519:&lt;pubkey&gt;</code>) are introduced via the trust graph (<code>gatos/trust/graph.json</code>). Groups (e.g., <code>@leads</code>) resolve against this graph.</li><li><strong>Rotation Cadence:</strong> Keys SHOULD be rotated on a regular cadence (e.g., quarterly). Rotations are committed as updates to the trust graph and distributed like any other state.</li><li><strong>Revocation:</strong> Revoked or compromised keys MUST be recorded under <code>refs/gatos/trust/revocations/</code> and propagated. The Policy Gate denies any action attested by a revoked key.</li><li><strong>Grant Staleness:</strong> Grants bind to a policy and trust snapshot. When the trust graph or policy changes (e.g., signer revoked), stale grants MUST be rejected by the Gate until re-authorized.</li></ul><h2 id="consensus-governance" tabindex="-1">Consensus Governance <a class="header-anchor" href="#consensus-governance" aria-label="Permalink to &quot;Consensus Governance&quot;">​</a></h2><p><a id="consensus-governance"></a> For particularly sensitive actions, a policy might require more than just a single actor&#39;s approval. GATOS supports <strong>N-of-M consensus</strong>, where a certain number of approvals from a defined group of actors is required.</p><p>This workflow is managed by the Policy Plane:</p><ol><li><strong>Proposal:</strong> An actor creates a <strong><code>Proposal</code></strong> commit, which describes the action they want to perform (e.g., deploy a new version of a service). This proposal is stored under <code>refs/gatos/proposals/</code>.</li><li><strong>Approval:</strong> Members of the required group (e.g., <code>@leads</code>) create <strong><code>Approval</code></strong> commits, which are cryptographically signed attestations that reference the <code>Proposal-Id</code>. These are stored under <code>refs/gatos/approvals/</code>.</li><li><strong>Quorum Check:</strong> The <code>gatos-policy</code> engine watches for new approvals. When the number of valid approvals for a proposal reaches the required threshold (the <strong>quorum</strong>), the policy is satisfied.</li><li><strong>Grant:</strong> The engine then automatically creates a <strong><code>Grant</code></strong> commit. This grant contains a <strong>Proof-of-Consensus</strong>—a canonical hash of the proposal and all the valid approvals used to meet the quorum.</li><li><strong>Execution:</strong> The original actor can now re-submit their event, this time presenting the <code>Grant</code> as proof that the action has been authorized by the group.</li></ol><figure><img src="'+n+`" alt="diagram 2" loading="lazy"></figure><p>This entire process is orchestrated by the Policy Plane and recorded in Git, providing a fully transparent and verifiable governance workflow.</p><h3 id="quorum-example-deploy-requires-2-3-of-leads" tabindex="-1">Quorum Example (Deploy requires 2/3 of @leads) <a class="header-anchor" href="#quorum-example-deploy-requires-2-3-of-leads" aria-label="Permalink to &quot;Quorum Example (Deploy requires 2/3 of @leads)&quot;">​</a></h3><p><a id="quorum-example-deploy-requires-23-of-leads"></a> Refs touched:</p><ul><li>Proposal → <code>refs/gatos/proposals/&lt;ulid&gt;</code></li><li>Approvals → <code>refs/gatos/approvals/&lt;proposal-id&gt;/&lt;signer&gt;</code> (one per signer)</li><li>Grant → <code>refs/gatos/grants/&lt;proposal-id&gt;</code></li></ul><p>Proof-of-Consensus (PoC) envelope (canonical JSON):</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;proposal&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;blake3:&lt;hex&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;deploy.production&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;target&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;gatos://service/api&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;approvals&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;signer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ed25519:&lt;pubkey-1&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;approval_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;blake3:&lt;hex&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;signer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ed25519:&lt;pubkey-2&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;approval_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;blake3:&lt;hex&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;rule&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;governance.deploy.production&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;quorum&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2-of-3@leads&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Grant trailers include: <code>Proposal-Id</code>, <code>Grant-Id</code>, <code>Proof-Of-Consensus: blake3(envelope_bytes)</code>.</p><h2 id="summary" tabindex="-1">Summary <a class="header-anchor" href="#summary" aria-label="Permalink to &quot;Summary&quot;">​</a></h2><p><a id="summary"></a> The Policy Plane is the brain of GATOS. It transforms the system from a simple event log into a true governance platform. By evaluating every action against a set of version-controlled rules and managing a capability-based security model, <code>gatos-policy</code> ensures that the GATOS operating surface is not just deterministic and auditable, but also secure and compliant with the defined rules of the system.</p>`,34)])])}const y=a(r,[["render",l]]);export{k as __pageData,y as default};
