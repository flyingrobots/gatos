{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://gatos.dev/schemas/v1/shiplog/event_envelope.schema.json",
  "title": "GATOS Shiplog Event Envelope (v1 Canonical JSON)",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "ulid",
    "topic",
    "type",
    "payload"
  ],
  "properties": {
    "ulid": {
      "type": "string",
      "pattern": "^[0-9A-HJKMNP-TV-Z]{26}$",
      "description": "ULID (26 chars, Crockford base32, uppercase, no I/L/O/U)"
    },
    "type": {
      "type": "string",
      "minLength": 1
    },
    "payload": {
      "type": "object"
    },
    "refs": {
      "type": "object",
      "propertyNames": {
        "pattern": "^[a-z][a-z0-9._-]{0,63}$"
      },
      "additionalProperties": {
        "$ref": "../common/ids.schema.json#/$defs/blake3Digest"
      },
      "description": "Optional cross-references to related state roots or objects (blake3:...)."
    },
    "topic": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9._-]{0,63}$",
      "description": "Topic name (ASCII, lowercase start)."
    }
  },
  "description": "Canonical Shiplog event envelope. Content-Id = blake3(JCS(envelope)). Precisionâ€‘sensitive values (e.g., money/time) MUST be encoded as integers or strings. Payload MUST NOT embed private data; replace with Opaque Pointer per privacy schema."
}
