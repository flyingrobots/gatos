{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "GATOS Opaque Pointer",
  "description": "A canonical pointer to a private data blob, used to replace sensitive or large data in a public state projection.",
  "type": "object",
  "properties": {
    "kind": {
      "description": "The object kind, MUST be 'opaque_pointer'.",
      "type": "string",
      "const": "opaque_pointer"
    },
    "algo": {
      "description": "The hashing algorithm used for the digest, MUST be 'blake3'.",
      "type": "string",
      "const": "blake3"
    },
    "digest": {
      "description": "The content-address of the private blob, prefixed with the algorithm.",
      "type": "string",
      "pattern": "^blake3:[a-f0-9]{64}$"
    },
    "size": {
      "description": "Optional: The size of the private blob in bytes.",
      "type": "integer",
      "minimum": 0
    },
    "location": {
      "description": "A URI indicating where the private blob can be resolved.",
      "type": "string",
      "format": "uri"
    },
    "capability": {
      "description": "A URI defining the authorization and/or decryption mechanism for the blob.",
      "type": "string",
      "format": "uri"
    }
  },
  "required": [
    "kind",
    "algo",
    "digest",
    "location",
    "capability"
  ],
  "additionalProperties": false
}
