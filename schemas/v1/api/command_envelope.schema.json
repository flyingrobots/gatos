{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://gatos.io/schemas/v1/api/command_envelope.schema.json",
  "title": "GATOS Command Envelope",
  "type": "object",
  "additionalProperties": false,
  "required": ["type", "args", "request_id"],
  "properties": {
    "type": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9_.-]+$",
      "description": "Verb.noun style identifier (e.g., locks.acquire)."
    },
    "args": {
      "type": "object",
      "description": "Command-specific arguments."
    },
    "expect_state": {
      "type": "string",
      "pattern": "^[0-9a-fA-F]{40}$",
      "description": "Optional expected state SHA."
    },
    "request_id": {
      "type": "string",
      "pattern": "^[0-9A-HJKMNP-TV-Z]{26}$",
      "description": "ULID used for idempotency."
    },
    "sync": {
      "type": "boolean",
      "description": "Optional hint requesting synchronous execution when supported."
    }
  }
}
