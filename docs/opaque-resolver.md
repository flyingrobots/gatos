---
title: Opaque Pointer Resolver API
---

# Opaque Pointer Resolver API

<a id="opaque-pointer-resolver-api"></a>

<a id="opaque-pointer-resolver-api"></a>

<a id="opaque-pointer-resolver-api"></a>

<!-- AUTOGENERATED TOC START -->

- [Request](#request)
- [Response](#response)
- [Audit](#audit)
- [Schemas](#schemas)

<!-- AUTOGENERATED TOC END -->

Normative default: Bearer JWT authentication; requests and decisions are audited.

## Request

<a id="request"></a>

<a id="request"></a>

<a id="request"></a>

Resolvers MUST expose a `.well-known` endpoint for the `gatos-node://` scheme defined in ADR-0004:

```http
GET /.well-known/gatos/private/<digest>
Authorization: Bearer <JWT>
Accept: application/octet-stream
Capability: gatos-key://v1/aes-256-gcm/<key-id>   # OPTIONAL when policy demands it
```

JWT claims:

- `sub` — subject
- `aud` — audience (resolver/repo id)
- `exp` — expiry (short-lived)
- Optional `scope` — dataset/namespace scope
- Optional `cap` — capability URI assertion (mirrors the pointer’s `capability`).

## Response

<a id="response"></a>

<a id="response"></a>

<a id="response"></a>

```http
200 OK
Digest: blake3=<hex>
X-BLAKE3-Digest: <hex>
Content-Type: application/octet-stream

<bytes>

Servers MUST recompute `blake3(plaintext)` and only return success when the digest matches the pointer envelope. Clients double-check using the `Digest` header.
```

## Audit

<a id="audit"></a>

<a id="audit"></a>

<a id="audit"></a>

On each resolve attempt, append an audit entry under `refs/gatos/audit/resolve/<ulid>` including:

```json
{ "ts": "<iso8601>", "alg": "blake3", "digest": "<hex>", "sub": "<sub>", "aud": "<aud>", "decision": "ALLOW|DENY" }
```

## Schemas

<a id="schemas"></a>

<a id="schemas"></a>

<a id="schemas"></a>

See JSON Schemas in `docs/schemas/opaque-resolver.request.schema.json` and `docs/schemas/opaque-resolver.response.schema.json`.
